<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MEDU Case Vault - Where Medicine Meets Mystery</title>
<style>
  /* =====================
     Variables and Themes
  ===================== */
  :root {
    --blue: #1a2e4c;
    --cyan: #00cfff;
    --light-blue: #4dcfff;
    --white: #e6f0fa;
    --dark-bg: #0a1626;
    --gray-dark: #2a3a50;
    --gray-light: #7a8ba6;
    --shadow-color: rgba(0, 195, 255, 0.3);
    --font-sans: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    --radius: 12px;
    --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  [data-theme="dark"] {
    --blue: #70e1ff;
    --cyan: #00b7ff;
    --light-blue: #4dcfff;
    --white: #f5faff;
    --dark-bg: #061521;
    --gray-dark: #142a44;
    --gray-light: #a8caff;
    --shadow-color: rgba(0, 195, 255, 0.7);
  }

  /* ==============
     Reset + Base
  ============== */
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  html {
    scroll-behavior: smooth;
    font-size: 16px;
  }
  body {
    background: var(--dark-bg);
    color: var(--white);
    font-family: var(--font-sans);
    line-height: 1.5;
    min-height: 100vh;
    transition: background var(--transition), color var(--transition);
  }
  a {
    color: var(--cyan);
    text-decoration: none;
  }
  a:hover, a:focus {
    text-decoration: underline;
  }
  button {
    cursor: pointer;
    font-family: var(--font-sans);
    background: var(--cyan);
    border: none;
    border-radius: var(--radius);
    padding: 0.6em 1.4em;
    font-weight: 600;
    color: var(--dark-bg);
    box-shadow: 0 0 10px var(--shadow-color);
    transition: background-color var(--transition), box-shadow var(--transition), transform var(--transition);
  }
  button:hover, button:focus {
    background-color: var(--light-blue);
    box-shadow: 0 0 20px var(--shadow-color);
    transform: translateY(-3px);
    outline: none;
  }
  input, select, textarea {
    border-radius: var(--radius);
    border: none;
    padding: 0.5em 0.8em;
    font-size: 1rem;
    width: 100%;
    max-width: 400px;
    margin-top: 0.3em;
  }
  input:focus, select:focus, textarea:focus {
    outline: 2px solid var(--cyan);
    outline-offset: 2px;
  }
  h1, h2, h3, h4 {
    font-weight: 700;
    text-shadow: 0 0 8px var(--shadow-color);
  }
  h1 { font-size: 3.2rem; margin-bottom: 0.2em; }
  h2 { font-size: 2.4rem; margin-bottom: 0.8em; }
  h3 { font-size: 1.6rem; margin-bottom: 0.5em; }
  p {
    font-size: 1.05rem;
    color: var(--white);
    margin-bottom: 1em;
  }

  /* ==============
     Layout
  ============== */
  nav {
    position: sticky;
    top: 0;
    z-index: 10000;
    background: var(--blue);
    padding: 1em 2em;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 15px var(--shadow-color);
  }
  nav .logo {
    font-weight: 900;
    font-size: 1.5rem;
    color: var(--white);
    letter-spacing: 2px;
    user-select: none;
  }
  nav ul {
    display: flex;
    list-style: none;
    gap: 1.6em;
    flex-wrap: wrap;
  }
  nav li {
    user-select: none;
  }
  nav li.hidden {
    display: none;
  }
  nav a {
    font-weight: 600;
    color: var(--white);
    padding: 0.4em 0.8em;
    border-radius: var(--radius);
    transition: background-color var(--transition);
  }
  nav a:hover, nav a:focus {
    background-color: var(--cyan);
    color: var(--dark-bg);
    outline: none;
  }
  nav button#themeToggle {
    background: transparent;
    font-size: 1.7rem;
    box-shadow: none;
    color: var(--white);
    padding: 0.2em 0.6em 0 0.6em;
    border-radius: 50%;
    transition: color var(--transition);
  }
  nav button#themeToggle:hover {
    color: var(--cyan);
  }

  main {
    max-width: 1200px;
    margin: 2rem auto 6rem;
    padding: 0 1.4rem;
  }

  /* ==============
     HERO SECTION
  ============== */
  .hero {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 85vh;
    background: linear-gradient(135deg, var(--blue), var(--cyan));
    border-radius: var(--radius);
    text-align: center;
    box-shadow: 0 0 30px var(--shadow-color);
    user-select: none;
    position: relative;
  }
  .hero h1 {
    font-size: 4.5rem;
    margin-bottom: 0.3rem;
    letter-spacing: 3px;
    text-transform: uppercase;
  }
  .hero p.subtitle {
    font-weight: 600;
    font-size: 1.3rem;
    margin-bottom: 0.1rem;
    opacity: 0.85;
    font-style: italic;
    letter-spacing: 0.8px;
  }
  .hero p.author {
    font-size: 1rem;
    opacity: 0.7;
    margin-bottom: 2.2rem;
  }
  .hero button#enterVault {
    font-size: 1.3rem;
    padding: 1em 3em;
    font-weight: 900;
    box-shadow: 0 0 20px var(--shadow-color);
    border: 2px solid var(--white);
    color: var(--white);
    background: transparent;
    transition:
      background-color 0.4s ease,
      color 0.4s ease,
      box-shadow 0.4s ease,
      transform 0.3s ease;
  }
  .hero button#enterVault:hover,
  .hero button#enterVault:focus {
    background-color: var(--white);
    color: var(--dark-bg);
    box-shadow: 0 0 40px var(--shadow-color);
    transform: translateY(-5px);
    outline: none;
  }

  /* ==============
     SECTIONS
  ============== */
  section {
    margin-bottom: 4rem;
    opacity: 0;
    transform: translateY(20px);
    animation-fill-mode: forwards;
    animation-name: fadeInUp;
    animation-duration: 0.7s;
  }
  section.visible {
    opacity: 1;
    transform: translateY(0);
  }
  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  section h2 {
    display: flex;
    align-items: center;
    gap: 0.6em;
    margin-bottom: 1rem;
    user-select: none;
  }
  section p.intro {
    margin-bottom: 1.5rem;
    font-size: 1.1rem;
    opacity: 0.85;
  }

  /* ==============
     GAMES GRID
  ============== */
  .games-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));
    gap: 2rem;
  }
  .game-card {
    background: var(--gray-dark);
    border-radius: var(--radius);
    padding: 1.6rem 2rem;
    box-shadow: 0 0 15px var(--shadow-color);
    cursor: pointer;
    color: var(--white);
    display: flex;
    flex-direction: column;
    align-items: center;
    transition:
      transform var(--transition),
      box-shadow var(--transition),
      background-color var(--transition);
    user-select: none;
    outline-offset: 4px;
  }
  .game-card:focus,
  .game-card:hover {
    background-color: var(--blue);
    box-shadow: 0 0 40px var(--shadow-color);
    transform: translateY(-10px);
    outline: none;
  }
  .game-card span.icon {
    font-size: 4rem;
    margin-bottom: 1rem;
    filter: drop-shadow(0 0 3px var(--cyan));
  }
  .game-card h3 {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
  }
  .game-card p {
    text-align: center;
    font-size: 1rem;
    opacity: 0.85;
    line-height: 1.4;
  }

  /* ==============
     SHADOW CASES LOCKER
  ============== */
  .locker {
    background: var(--gray-dark);
    border-radius: var(--radius);
    padding: 3rem 2rem;
    text-align: center;
    font-size: 1.2rem;
    font-style: italic;
    color: var(--gray-light);
    box-shadow: inset 0 0 20px var(--shadow-color);
    user-select: none;
  }

  /* ==============
     ANATOMY EXPLORER
  ============== */
  .anatomy-map {
    margin: 0 auto;
    max-width: 650px;
    background: var(--gray-dark);
    border-radius: var(--radius);
    padding: 1.4rem;
    box-shadow: 0 0 20px var(--shadow-color);
    user-select: none;
  }
  .anatomy-map svg {
    width: 100%;
    height: auto;
    cursor: pointer;
  }
  .organ {
    fill: var(--blue);
    transition: fill 0.3s ease;
  }
  .organ:hover, .organ:focus {
    fill: var(--cyan);
    outline: none;
    filter: drop-shadow(0 0 10px var(--cyan));
  }
  .organ-label {
    fill: var(--white);
    font-size: 1rem;
    pointer-events: none;
    user-select: none;
  }

  /* ==============
     EVIDENCE SCANNER
  ============== */
  .scanner-box {
    background: var(--gray-dark);
    border: 2px dashed var(--cyan);
    border-radius: var(--radius);
    padding: 3rem;
    text-align: center;
    font-size: 1.4rem;
    color: var(--cyan);
    box-shadow: 0 0 30px var(--shadow-color);
    user-select: none;
    transition: background-color 0.4s ease, color 0.4s ease;
  }
  .scanner-box.dragover {
    background-color: var(--cyan);
    color: var(--dark-bg);
  }
  #scanResult {
    margin-top: 1rem;
    font-weight: 700;
    min-height: 1.4rem;
  }

  /* ==============
     CASE REPORT GENERATOR
  ============== */
  #reportArea > div {
    background: var(--gray-dark);
    padding: 1.5rem 2rem;
    border-radius: var(--radius);
    box-shadow: 0 0 25px var(--shadow-color);
    margin-top: 1rem;
    color: var(--white);
    user-select: text;
  }
  #reportArea > div button {
    margin-top: 1rem;
    background: var(--cyan);
    color: var(--dark-bg);
    font-weight: 700;
  }

  /* ==============
     LEADERBOARD TABLE
  ============== */
  .leaderboard {
    overflow-x: auto;
  }
  .leaderboard table {
    width: 100%;
    border-collapse: collapse;
    background: var(--gray-dark);
    box-shadow: 0 0 25px var(--shadow-color);
    border-radius: var(--radius);
    overflow: hidden;
  }
  .leaderboard th, .leaderboard td {
    padding: 1rem 1.4rem;
    text-align: center;
    color: var(--white);
    user-select: none;
  }
  .leaderboard th {
    background: var(--blue);
    font-weight: 700;
    letter-spacing: 1px;
  }
  .leaderboard tbody tr:nth-child(even) {
    background: var(--gray-light);
    color: var(--dark-bg);
  }
  .rank-bronze {
    background: #cd7f32;
    color: #fff;
    font-weight: 700;
  }
  .rank-silver {
    background: #c0c0c0;
    color: #333;
    font-weight: 700;
  }
  .rank-gold {
    background: #ffd700;
    color: #333;
    font-weight: 700;
  }
  .rank-platinum {
    background: #e5e4e2;
    color: #333;
    font-weight: 700;
  }

  /* ==============
     ADMIN PANEL
  ============== */
  .admin-panel {
    background: var(--gray-dark);
    border-radius: var(--radius);
    padding: 2rem;
    box-shadow: 0 0 30px var(--shadow-color);
    user-select: none;
  }
  .admin-panel form {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.6rem 3rem;
  }
  .admin-panel label {
    font-weight: 700;
    display: block;
    color: var(--cyan);
  }
  .admin-panel input, .admin-panel select {
    margin-top: 0.4rem;
    background: var(--dark-bg);
    border: 2px solid var(--cyan);
    color: var(--white);
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }
  .admin-panel input:focus, .admin-panel select:focus {
    border-color: var(--light-blue);
    outline: none;
  }
  .admin-panel button {
    grid-column: span 2;
    margin-top: 1.2rem;
  }

  /* ==============
     TIMELINE / ARCHIVES
  ============== */
  .timeline {
    border-left: 4px solid var(--cyan);
    margin-left: 1rem;
    padding-left: 1.5rem;
  }
  .entry {
    position: relative;
    margin-bottom: 2rem;
  }
  .entry::before {
    content: '';
    position: absolute;
    left: -13px;
    top: 8px;
    width: 20px;
    height: 20px;
    background: var(--cyan);
    border-radius: 50%;
    box-shadow: 0 0 15px var(--shadow-color);
  }
  .entry h4 {
    margin-bottom: 0.6rem;
    user-select: none;
  }
  .entry p {
    font-size: 1rem;
    opacity: 0.85;
  }

  /* ==============
     MODAL
  ============== */
  .modal-bg {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0,0,0,0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 9999;
  }
  .modal-bg.active {
    visibility: visible;
    opacity: 1;
  }
  .modal {
    background: var(--gray-dark);
    border-radius: var(--radius);
    max-width: 500px;
    width: 90%;
    padding: 2rem;
    box-shadow: 0 0 40px var(--shadow-color);
    color: var(--white);
    position: relative;
    user-select: text;
  }
  .modal h3 {
    margin-bottom: 1rem;
  }
  .modal p {
    margin-bottom: 1.2rem;
    font-size: 1.1rem;
    line-height: 1.4;
  }
  .modal button.close-modal {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: transparent;
    border: none;
    font-size: 1.7rem;
    color: var(--cyan);
    cursor: pointer;
  }
  .modal button.close-modal:hover {
    color: var(--light-blue);
  }

  /* ==============
     RESPONSIVE
  ============== */
  @media (max-width: 768px) {
    nav ul {
      display: none;
    }
    nav ul.open {
      display: flex;
      flex-direction: column;
      gap: 1.2em;
      position: fixed;
      top: 60px;
      right: 0;
      background: var(--blue);
      width: 220px;
      padding: 1.5rem;
      border-radius: 0 0 0 var(--radius);
      box-shadow: 0 0 15px var(--shadow-color);
      z-index: 20000;
    }
    nav button#menuToggle {
      display: inline-block;
      background: transparent;
      font-size: 1.9rem;
      border: none;
      color: var(--white);
      cursor: pointer;
      padding: 0.2em 0.6em 0 0.6em;
      border-radius: 50%;
      box-shadow: none;
      user-select: none;
    }
    nav button#menuToggle:hover {
      color: var(--cyan);
    }
  }
  @media (min-width: 769px) {
    nav button#menuToggle {
      display: none;
    }
  }
</style>
</head>
<body data-theme="dark">
<nav>
  <div class="logo" tabindex="0" aria-label="MEDU Case Vault Logo">MEDU Case Vault</div>
  <ul id="navMenu" role="menubar" aria-label="Main Navigation">
    <li role="none"><a href="#games" role="menuitem" tabindex="0">Games</a></li>
    <li role="none"><a href="#anatomy" role="menuitem" tabindex="-1">Anatomy Explorer</a></li>
    <li role="none"><a href="#scanner" role="menuitem" tabindex="-1">Evidence Scanner</a></li>
    <li role="none"><a href="#report" role="menuitem" tabindex="-1">Case Reports</a></li>
    <li role="none"><a href="#leaderboard" role="menuitem" tabindex="-1">Leaderboard</a></li>
    <li role="none"><a href="#admin" role="menuitem" tabindex="-1">Admin Panel</a></li>
  </ul>
  <button id="themeToggle" aria-label="Toggle Dark/Light Mode" title="Toggle Dark/Light Mode">🌗</button>
  <button id="menuToggle" aria-label="Toggle Navigation Menu" title="Toggle Navigation Menu">☰</button>
</nav>

<main>
  <section class="hero" aria-label="Welcome Banner">
    <h1>MEDU Case Vault</h1>
    <p class="subtitle">Where Medicine Meets Mystery</p>
    <p class="author">Unlock your inner diagnostician</p>
    <button id="enterVault" aria-haspopup="true" aria-controls="games" aria-label="Enter the Case Vault">Enter Vault</button>
  </section>

  <section id="games" tabindex="0" aria-label="Games Section" aria-live="polite" aria-relevant="additions">
    <h2>🔬 MEDU Games Collection</h2>
    <p class="intro">Choose a game mode below to train your medical skills and challenge your mind.</p>
    <div class="games-grid" role="list">
      <div class="game-card" role="listitem" tabindex="0" data-game="diagnosis-duel" aria-label="Diagnosis Duel Game">
        <span class="icon" aria-hidden="true">🧠</span>
        <h3>Diagnosis Duel</h3>
        <p>1v1 competitive case-solving battle. Solve fast, solve right, climb ranks from Bronze to Platinum Medic.</p>
      </div>
      <div class="game-card" role="listitem" tabindex="0" data-game="er-escape" aria-label="ER Escape Room Game">
        <span class="icon" aria-hidden="true">🚨</span>
        <h3>ER Escape Room</h3>
        <p>Navigate emergency scenarios against time. Can you escape the chaos?</p>
      </div>
      <div class="game-card" role="listitem" tabindex="0" data-game="anatomy-puzzle" aria-label="Anatomy Puzzle Game">
        <span class="icon" aria-hidden="true">🧩</span>
        <h3>Anatomy Puzzle</h3>
        <p>Piece together organ systems and master human anatomy through interactive puzzles.</p>
      </div>
      <div class="game-card" role="listitem" tabindex="0" data-game="case-creator" aria-label="Case Creator Tool">
        <span class="icon" aria-hidden="true">✍️</span>
        <h3>Case Creator</h3>
        <p>Build and share your own medical mystery cases with custom branching logic and clues.</p>
      </div>
    </div>
  </section>

  <section id="anatomy" tabindex="0" aria-label="Anatomy Explorer Section">
    <h2>🫀 Anatomy Explorer</h2>
    <p class="intro">Click on an organ to learn detailed medical information and clinical correlations.</p>
    <div class="anatomy-map" role="img" aria-label="Diagram of human torso organs">
      <svg viewBox="0 0 500 700" role="presentation" aria-hidden="true" tabindex="-1" >
        <!-- Outline body -->
        <rect x="100" y="20" width="300" height="660" rx="50" ry="50" fill="#1f3350" />
        <!-- Organs -->
        <circle class="organ" id="heart" tabindex="0" cx="250" cy="200" r="45" aria-label="Heart, click for info" />
        <ellipse class="organ" id="lungs" tabindex="0" cx="250" cy="350" rx="80" ry="120" aria-label="Lungs, click for info" />
        <ellipse class="organ" id="liver" tabindex="0" cx="330" cy="520" rx="130" ry="70" aria-label="Liver, click for info" />
        <ellipse class="organ" id="stomach" tabindex="0" cx="170" cy="510" rx="90" ry="60" aria-label="Stomach, click for info" />
        <ellipse class="organ" id="brain" tabindex="0" cx="250" cy="80" rx="70" ry="50" aria-label="Brain, click for info" />
      </svg>
    </div>
  </section>

  <section id="scanner" tabindex="0" aria-label="Evidence Scanner Section">
    <h2>🔎 Evidence Scanner</h2>
    <p class="intro">Drag and drop medical images, reports, or clues below to analyze evidence.</p>
    <div class="scanner-box" id="scannerBox" tabindex="0" aria-dropeffect="copy" aria-label="Drop files here to scan">
      Drop files here or click to upload
      <input type="file" id="fileInput" accept="image/*,.pdf,.txt" style="display:none;" multiple />
    </div>
    <div id="scanResult" aria-live="polite" aria-atomic="true"></div>
  </section>

  <section id="report" tabindex="0" aria-label="Case Report Generator Section">
    <h2>📋 Case Report Generator</h2>
    <p class="intro">Generate detailed reports for your cases and print or share your findings.</p>
    <form id="reportForm" aria-label="Case report generation form">
      <label for="patientName">Patient Name:</label>
      <input type="text" id="patientName" name="patientName" required autocomplete="off" placeholder="John Doe" />
      <label for="caseSummary">Summary:</label>
      <textarea id="caseSummary" name="caseSummary" rows="4" required placeholder="Brief case description..."></textarea>
      <label for="diagnosis">Diagnosis:</label>
      <input type="text" id="diagnosis" name="diagnosis" required autocomplete="off" placeholder="Diagnosis here" />
      <label for="recommendations">Recommendations:</label>
      <textarea id="recommendations" name="recommendations" rows="3" placeholder="Treatment and advice..."></textarea>
      <button type="submit">Generate Report</button>
    </form>
    <div id="reportArea" aria-live="polite"></div>
  </section>

  <section id="leaderboard" tabindex="0" aria-label="Leaderboard Section">
    <h2>🏆 Leaderboard</h2>
    <p class="intro">Track the top players across all game modes and their ranks.</p>
    <div class="leaderboard" role="table" aria-label="Leaderboard table">
      <table>
        <thead>
          <tr>
            <th scope="col">Rank</th>
            <th scope="col">Player</th>
            <th scope="col">Game Mode</th>
            <th scope="col">Score</th>
            <th scope="col">Level</th>
          </tr>
        </thead>
        <tbody id="leaderboardBody">
          <!-- Dynamic leaderboard rows here -->
        </tbody>
      </table>
    </div>
  </section>

  <section id="admin" tabindex="0" aria-label="Admin Panel Section">
    <h2>🛠️ Admin Panel</h2>
    <p class="intro">Create new cases and manage game content (simulated, no backend).</p>
    <div class="admin-panel" role="region" aria-live="polite" aria-atomic="true">
      <form id="caseForm">
        <label for="caseName">Case Name</label>
        <input type="text" id="caseName" name="caseName" required autocomplete="off" placeholder="Enter case title" />
        <label for="caseDesc">Description</label>
        <textarea id="caseDesc" name="caseDesc" rows="3" required placeholder="Brief case summary"></textarea>
        <label for="caseType">Case Type</label>
        <select id="caseType" name="caseType" required>
          <option value="" disabled selected>Select type</option>
          <option value="diagnosis-duel">Diagnosis Duel</option>
          <option value="er-escape">ER Escape Room</option>
          <option value="anatomy-puzzle">Anatomy Puzzle</option>
          <option value="case-creator">Case Creator</option>
        </select>
        <button type="submit">Add Case</button>
      </form>
      <div id="adminMsg" aria-live="polite" style="margin-top:1rem;"></div>
    </div>
  </section>

  <!-- MODAL -->
  <div id="modal" class="modal-bg" role="dialog" aria-modal="true" aria-labelledby="modalTitle" tabindex="-1">
    <div class="modal" role="document">
      <button class="close-modal" aria-label="Close modal">×</button>
      <h3 id="modalTitle"></h3>
      <p id="modalContent"></p>
    </div>
  </div>
</main>

<script>
  (() => {
    'use strict';

    // Helper functions
    function select(selector, all = false) {
      return all ? [...document.querySelectorAll(selector)] : document.querySelector(selector);
    }
    function animateSection(section) {
      section.classList.add('visible');
    }

    // Animate sections on scroll
    function handleScrollAnimation() {
      const sections = select('section', true);
      const triggerBottom = window.innerHeight * 0.85;
      sections.forEach(section => {
        const sectionTop = section.getBoundingClientRect().top;
        if (sectionTop < triggerBottom) {
          animateSection(section);
        }
      });
    }

    window.addEventListener('scroll', handleScrollAnimation);
    window.addEventListener('load', () => {
      handleScrollAnimation();
    });

    // Navigation menu mobile toggle
    const menuToggle = select('#menuToggle');
    const navMenu = select('#navMenu');
    menuToggle.addEventListener('click', () => {
      navMenu.classList.toggle('open');
      if(navMenu.classList.contains('open')){
        navMenu.querySelectorAll('a').forEach((a,i) => a.tabIndex = 0);
      } else {
        navMenu.querySelectorAll('a').forEach((a,i) => a.tabIndex = -1);
      }
    });

    // Dark/light theme toggle
    const themeToggle = select('#themeToggle');
    themeToggle.addEventListener('click', () => {
      const currentTheme = document.body.getAttribute('data-theme');
      if(currentTheme === 'dark'){
        document.body.setAttribute('data-theme', 'light');
        themeToggle.textContent = '🌑';
      } else {
        document.body.setAttribute('data-theme', 'dark');
        themeToggle.textContent = '🌗';
      }
    });

    // HERO ENTER VAULT BUTTON
    const enterVaultBtn = select('#enterVault');
    enterVaultBtn.addEventListener('click', () => {
      document.querySelector('#games').scrollIntoView({behavior: 'smooth'});
      navMenu.classList.remove('open');
    });

    // GAME CARDS interaction - open modal with details
    const modal = select('#modal');
    const modalTitle = select('#modalTitle');
    const modalContent = select('#modalContent');
    const closeModalBtn = select('.close-modal');

    const gameData = {
      'diagnosis-duel': {
        title: "Diagnosis Duel",
        content: `
          <strong>Description:</strong> Compete in a 1v1 match where both players receive the same case. The faster and more accurate diagnostician wins.<br><br>
          <strong>Mechanics:</strong> You get patient data, symptoms, and tests. Choose diagnostics and treatments carefully.<br><br>
          <strong>Ranks:</strong> Bronze → Silver → Gold → Platinum Medic<br><br>
          <strong>Tip:</strong> Speed and precision are key. Review patient history carefully and use differential diagnosis logic.
        `
      },
      'er-escape': {
        title: "ER Escape Room",
        content: `
          <strong>Description:</strong> Immerse yourself in a chaotic emergency room. You must stabilize patients and make quick decisions to escape alive.<br><br>
          <strong>Challenges:</strong> Multiple emergencies happen simultaneously; triage, prioritize, and treat in real time.<br><br>
          <strong>Goal:</strong> Escape the ER within the time limit.<br><br>
          <strong>Tip:</strong> Stay calm and don't forget basic emergency protocols.
        `
      },
      'anatomy-puzzle': {
        title: "Anatomy Puzzle",
        content: `
          <strong>Description:</strong> Piece together organ systems and understand anatomy by solving interactive puzzles.<br><br>
          <strong>Features:</strong> Drag and drop organs, learn detailed facts, and quiz yourself.<br><br>
          <strong>Goal:</strong> Master human anatomy and earn badges.<br><br>
          <strong>Tip:</strong> Use the Anatomy Explorer to study before playing.
        `
      },
      'case-creator': {
        title: "Case Creator",
        content: `
          <strong>Description:</strong> Build your own medical mystery case! Add symptoms, tests, branching logic, and possible outcomes.<br><br>
          <strong>Features:</strong> Share your cases and challenge friends.<br><br>
          <strong>Tip:</strong> Think like a diagnostician; make clues clear but challenging.
        `
      }
    };

    selectAll('.game-card').forEach(card => {
      card.addEventListener('click', () => {
        const gameKey = card.dataset.game;
        if(gameData[gameKey]){
          modalTitle.innerHTML = gameData[gameKey].title;
          modalContent.innerHTML = gameData[gameKey].content;
          openModal();
        }
      });
      card.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          card.click();
        }
      });
    });

    // Modal open/close
    function openModal(){
      modal.classList.add('active');
      modal.focus();
      document.body.style.overflow = 'hidden';
    }
    function closeModal(){
      modal.classList.remove('active');
      document.body.style.overflow = '';
    }
    closeModalBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', e => {
      if(e.target === modal){
        closeModal();
      }
    });
    window.addEventListener('keydown', e => {
      if(e.key === 'Escape' && modal.classList.contains('active')){
        closeModal();
      }
    });

    // Helper for selecting all elements
    function selectAll(selector){
      return [...document.querySelectorAll(selector)];
    }

    // Anatomy Explorer functionality
    const organData = {
      heart: {
        name: 'Heart',
        description: 'The heart pumps oxygenated blood throughout the body. Common diseases include myocardial infarction, arrhythmias, and heart failure.'
      },
      lungs: {
        name: 'Lungs',
        description: 'The lungs enable gas exchange, providing oxygen and removing carbon dioxide. Conditions include pneumonia, asthma, and COPD.'
      },
      liver: {
        name: 'Liver',
        description: 'The liver detoxifies blood, produces bile, and stores glycogen. Diseases include hepatitis, cirrhosis, and liver cancer.'
      },
      stomach: {
        name: 'Stomach',
        description: 'The stomach aids digestion by breaking down food with acid and enzymes. Issues include gastritis, ulcers, and cancer.'
      },
      brain: {
        name: 'Brain',
        description: 'The brain controls body functions and cognition. Neurological disorders include stroke, epilepsy, and Alzheimer’s disease.'
      }
    };
    selectAll('.organ').forEach(organEl => {
      organEl.addEventListener('click', () => {
        const id = organEl.id;
        if(organData[id]){
          modalTitle.textContent = organData[id].name;
          modalContent.textContent = organData[id].description;
          openModal();
        }
      });
      organEl.addEventListener('keydown', e => {
        if(e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          organEl.click();
        }
      });
    });

    // Evidence Scanner drag-drop and click to upload
    const scannerBox = select('#scannerBox');
    const fileInput = select('#fileInput');
    const scanResult = select('#scanResult');

    scannerBox.addEventListener('dragover', e => {
      e.preventDefault();
      scannerBox.classList.add('dragover');
    });
    scannerBox.addEventListener('dragleave', e => {
      scannerBox.classList.remove('dragover');
    });
    scannerBox.addEventListener('drop', e => {
      e.preventDefault();
      scannerBox.classList.remove('dragover');
      handleFiles(e.dataTransfer.files);
    });
    scannerBox.addEventListener('click', () => {
      fileInput.click();
    });
    fileInput.addEventListener('change', e => {
      handleFiles(fileInput.files);
    });

    function handleFiles(files){
      if(files.length === 0) return;
      scanResult.textContent = `Scanning ${files.length} file(s)... 🩺`;
      setTimeout(() => {
        scanResult.textContent = "File scanned. 🩺 Suggestion: Possible pneumonia.";
      }, 1500);
    }

    // Case Report Generator
    const reportForm = select('#reportForm');
    const reportArea = select('#reportArea');

    reportForm.addEventListener('submit', e => {
      e.preventDefault();
      const patientName = reportForm.patientName.value.trim();
      const caseSummary = reportForm.caseSummary.value.trim();
      const diagnosis = reportForm.diagnosis.value.trim();
      const recommendations = reportForm.recommendations.value.trim();
      if(!patientName || !caseSummary || !diagnosis) return;

      const timestamp = new Date().toLocaleString();
      const badge = "🩺 MEDU Medic";
      const rank = "Silver";

      const reportHTML = `
        <div role="region" aria-label="Generated Case Report">
          <h3>Case Report for <strong>${patientName}</strong></h3>
          <p><strong>Badge:</strong> ${badge}</p>
          <p><strong>Rank:</strong> ${rank}</p>
          <p><strong>Date:</strong> ${timestamp}</p>
          <hr style="margin:1em 0; border-color: var(--cyan);"/>
          <h4>Summary</h4>
          <p>${caseSummary}</p>
          <h4>Diagnosis</h4>
          <p>${diagnosis}</p>
          <h4>Recommendations</h4>
          <p>${recommendations || 'N/A'}</p>
          <button id="printReport" aria-label="Print case report">Print Report</button>
        </div>
      `;
      reportArea.innerHTML = reportHTML;

      // Print button listener
      select('#printReport').addEventListener('click', () => {
        const printContents = reportArea.innerHTML;
        const originalContents = document.body.innerHTML;
        document.body.innerHTML = printContents;
        window.print();
        document.body.innerHTML = originalContents;
        window.location.reload();
      });

      reportForm.reset();
    });

    // Leaderboard dynamic data
    const leaderboardBody = select('#leaderboardBody');
    const leaderboardEntries = [
      {rank: "Platinum Medic", player: "DrApex", game: "Diagnosis Duel", score: 9200, level: 45},
      {rank: "Gold Medic", player: "MedicNova", game: "ER Escape Room", score: 8600, level: 38},
      {rank: "Silver Medic", player: "AnatomyAce", game: "Anatomy Puzzle", score: 7100, level: 33},
      {rank: "Bronze Medic", player: "CaseBuilder", game: "Case Creator", score: 5600, level: 27},
      {rank: "Gold Medic", player: "SurgeonX", game: "Diagnosis Duel", score: 8000, level: 36}
    ];

    function renderLeaderboard(){
      leaderboardBody.innerHTML = "";
      leaderboardEntries.forEach(entry => {
        let rankClass = "";
        switch(entry.rank.toLowerCase()){
          case "bronze medic": rankClass = "rank-bronze"; break;
          case "silver medic": rankClass = "rank-silver"; break;
          case "gold medic": rankClass = "rank-gold"; break;
          case "platinum medic": rankClass = "rank-platinum"; break;
          default: rankClass = "";
        }
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="${rankClass}">${entry.rank}</td>
          <td>${entry.player}</td>
          <td>${entry.game}</td>
          <td>${entry.score.toLocaleString()}</td>
          <td>${entry.level}</td>
        `;
        leaderboardBody.appendChild(tr);
      });
    }
    renderLeaderboard();

    // Admin panel case submission simulation
    const adminSection = select('#admin');
    const caseForm = select('#caseForm');
    const adminMsg = select('#adminMsg');

    function checkAdminMode() {
      const params = new URLSearchParams(window.location.search);
      if(params.get('admin') === 'true'){
        // Show admin panel menu item and section
        navMenu.querySelector('li:nth-child(6)').classList.remove('hidden');
        caseForm.querySelector('button').disabled = false;
        adminSection.scrollIntoView({behavior: 'smooth'});
      } else {
        // Hide admin panel menu item and section from tabbing
        navMenu.querySelector('li:nth-child(6)').classList.add('hidden');
        caseForm.querySelector('button').disabled = true;
      }
    }
    checkAdminMode();

    caseForm.addEventListener('submit', e => {
      e.preventDefault();
      const name = caseForm.caseName.value.trim();
      const desc = caseForm.caseDesc.value.trim();
      const type = caseForm.caseType.value;
      if(!name || !desc || !type){
        adminMsg.textContent = "Please fill all fields.";
        adminMsg.style.color = "#ff6b6b";
        return;
      }
      // Simulate adding case (in real app this would post to backend)
      adminMsg.textContent = `Case "${name}" added to ${type.replace(/-/g,' ')} games. (Simulation)`;
      adminMsg.style.color = "#00ffea";
      caseForm.reset();
      setTimeout(() => { adminMsg.textContent = ''; }, 5000);
    });

  })();
</script>
</body>
</html>
